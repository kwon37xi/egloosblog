<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../../css/result.css">

        <title>Ajax 기본 예제와 JSP 엔진에서 한글 인코딩 충돌 문제 처리</title>
    </head>
    <body>
        <section id="wrap">
            <header>
                <h1 class="logo-title">
                    <span class="main"><img src="../../images/logo_egloos.png" width="105" height="34" alt="이글루스"></span>
                </h1>
                <div class="user-info">
                    <strong class="name">권남</strong> 님 (<strong class="name">kwon37xi</strong>)
                </div>
            </header>
            <main>
                <article class="post-wrap">
                    <!-- 게시물 정보 : 날짜 -->
                    <div class="post-info">
                        <span class="time">2006-07-12 23:08:38</span>
                    </div>
                    <!-- 게시물 제목 -->
                    <h2 class="post-title">Ajax 기본 예제와 JSP 엔진에서 한글 인코딩 충돌 문제 처리</h2>
                    <!-- 게시물 본문 -->
                    <div class="post-body">
                        <div class="content">Ajax가 필요한 일이 발생해서, 급조해서 Ajax를 공부했다.<br>공부한 책은 <a title="" href="http://kangcom.com/common/bookinfo/bookinfo.asp?sku=200601180062">Ajax 입문</a>이며, 처음 약 5~60 페이지만 읽었다. 급조한 내용이니 너무 신뢰하지 말 것. 아.. 그리고 이 책, 중대한 오탈자가 은근히 있다. 혹시 이 책으로 공부하고자 한다면 <a title="" href="http://www.hanbitbook.co.kr/errata/view.php?isbn=89-7914-310-9">오탈자를 확인</a>한 뒤에 공부해서 불필요한 시간 낭비를 줄이는 것이 좋겠다.<br><br>아무튼, 책의 내용중 Ajax의 기본적인 사용에 관한 문제를 정리하고, 또 JSP/Servlet 엔진에서 Ajax사용시에 발생하는 한글 인코딩(encoding)문제의 처리방법도 정리해 둔다.<br>Ajax의 개념에 관한 설명은 인터넷 상에 차고 넘치므로 생략.<br><br> * <a href="http://network.hanbitbook.co.kr/view.php?bi_id=1088">A Simpler Ajax Path</a>가 Ajax 입문에 좋은 글.<br><br><div class="h2">Ajax의 개발 순서</div><br> 1. XMLHttpRequest 객체 생성<br> 2. HTTP 요청을 발생시킴(open(), send())<br> 3. 서버측에서 XMLHttpRequest를 통해 보낸 요청을 받아서 파라미터를 분석하고, 작업을 한 뒤에 결과를 XML이나 문자열로 리턴한다.<br> 4. XMLHttpRequest로 서버가 리턴한 데이터를 받아서 처리(onreadystatechange, responseText, responseXML)<br><br><div class="h2">XMLHttpRequest에 의한 송수신 상세 예</div><br><div class="h3">JavaScript에서 XMLHttpRequest Object 생성하기</div><br><blockquote class="src">//&nbsp;XMLHttpRequest&nbsp;오브젝트&nbsp;생성&nbsp;함수<br>//&nbsp;@sample&nbsp;oj&nbsp;=&nbsp;createHttpRequest();<br>//&nbsp;@return&nbsp;XMLHttpRequest&nbsp;오브젝트<br>function&nbsp;createHttpRequest()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window.ActiveXObject)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;IE6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ActiveXObject("Msxml2.XMLHTTP");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(e)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;IE4,&nbsp;IE5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ActiveXObject("Microsoft.XMLHTTP");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(e2)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(window.XMLHttpRequest)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Mozilla,&nbsp;FireFox,&nbsp;Opera,&nbsp;Safari,&nbsp;Konqueror3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;XMLHttpRequest();<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></blockquote><br><br><div class="h3">HTTP 요청 발생</div><br>&nbsp;1. open() 메소드 실행 (POST/GET, 요청URL, 동기/비동기지정)<br><blockquote class="src">var&nbsp;request&nbsp;=&nbsp;createHttpRequest();<br>request.open("GET",&nbsp;"/test.xml");<br>&nbsp;<br>//&nbsp;param&nbsp;1&nbsp;:&nbsp;GET/POST<br>//&nbsp;param&nbsp;2&nbsp;:&nbsp;URL<br>//&nbsp;param&nbsp;3&nbsp;:&nbsp;생략가능.&nbsp;동기/비동기&nbsp;여부.&nbsp;기본&nbsp;비동기.<br></blockquote><br>&nbsp;2. send() 메소드(데이터 송신)<br><blockquote class="src">&nbsp;request.send("");&nbsp;//&nbsp;데이터&nbsp;없이&nbsp;전송할때&nbsp;혹은<br>&nbsp;request.send(null);&nbsp;//&nbsp;Konqueror에서는&nbsp;오류&nbsp;발생함.&nbsp;Konqueror를&nbsp;제외하고&nbsp;데이터&nbsp;없이&nbsp;전송할&nbsp;때&nbsp;사용가능<br></blockquote><br> 위 a,b가 기본적인 모양새이지만, 실제로 GET과 POST 방식에 따라 차이가 많이난다.<br><br>&nbsp;&nbsp;* GET 방식 : GET 방식은 URL에 파라미터를 직접 붙여 보내지만, 한글 등의 문제로 인코딩이 필요하고, RequestHeader 설정도 필요하다. 일반적으로 다음과 같은 모양이 된다.<br><blockquote class="src">var&nbsp;paramName&nbsp;=&nbsp;encodeURIComponent("파라미터명");&nbsp;//&nbsp;파라미터이름을&nbsp;UTF-8로&nbsp;인코딩<br>var&nbsp;paramValue&nbsp;=&nbsp;encodedURIComponent("파라미터값");&nbsp;//&nbsp;파라미터&nbsp;값을&nbsp;UTF-8로&nbsp;인코딩<br><br>//&nbsp;파라미터&nbsp;구분에&nbsp;사용되는&nbsp;?와&nbsp;&amp;는&nbsp;인코딩&nbsp;되면&nbsp;안된다.&nbsp;그래서&nbsp;따로&nbsp;붙인다.<br>var&nbsp;fullParameter&nbsp;=&nbsp;'?'&nbsp;+&nbsp;paramName&nbsp;+&nbsp;'='&nbsp;+&nbsp;paramValue;&nbsp;//&nbsp;URL에&nbsp;사용할&nbsp;파라미터&nbsp;구성<br><br>request.open("GET",&nbsp;"/test.cgi"&nbsp;+&nbsp;data);<br><br>//&nbsp;setRequestHeader()는&nbsp;open()보다&nbsp;이후에&nbsp;나와야만&nbsp;한다.<br>//&nbsp;아래는&nbsp;파라미터&nbsp;값을&nbsp;UTF-8로&nbsp;인코딩해서&nbsp;보내겠다는&nbsp;의미.<br>//&nbsp;GET방식에서는&nbsp;필요&nbsp;없고,&nbsp;POST방식에서는&nbsp;필수이다.<br>request.setRequestHeader('Content-Type',&nbsp;'application/x-www-form-urlencoded;&nbsp;charset=UTF-8');<br><br>request.send(null);<br></blockquote><br><br>&nbsp;&nbsp;* POST 방식 : send() 메소드에 인수를 데이터로 넘긴다.<br><blockquote class="src">request.open("POST",&nbsp;"/test.cgi");<br>request.setRequestHeader('Content-Type',&nbsp;'application/x-www-form-urlencoded;&nbsp;charset=UTF-8');<br>// POST 방식에서도 파라미터를 인코딩하여 send()메소드의 인자로 넘겨주면 된다.<br>request.send("name=test&amp;data=123");<br></blockquote><br><a href="http://network.hanbitbook.co.kr/view.php?bi_id=1088">A Simpler Ajax Path</a>에 보면 HTML폼에 입력된 값을 자동으로 파라미터 문자열로 변경해주는 메소드 예가 있다.<br><br><div class="h3">착신과 데이터 처리</div><br>&nbsp;* onreadystatechange 이벤트(송수신 상태 변할때 기동) - IE 이외 부라우저에서는 콜백 스타일의 onload 이벤트 사용가능<br>&nbsp;* readyState 프라퍼티 (송수신 상태를 나타내는 값. "4"가 송신 완료) - onload의 경우에는 불필요<br>onreadystatechange는 요청 처리 상태를 나타내는 readyState 프라퍼티의 값이 바뀔 때 발생한다.<br>&nbsp;* <strong>착신을 처리할 함수 지정은 request.open() 함수를 호출하기 전에 선언</strong>해야 정상 작동했다. 항상 요청을 보내기 전에 요청을 처리할 함수 지정을 해둔다.<br><blockquote class="src">request.onreadystatechange&nbsp;=&nbsp;callbackFunction;&nbsp;//&nbsp;callbackFunction()&nbsp;함수가&nbsp;호출된다.<br><br>function&nbsp;callbackFunction()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;readyState&nbsp;==&nbsp;4는&nbsp;착신&nbsp;완료를&nbsp;의미한다.<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request.readyState&nbsp;==&nbsp;4)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;착신시의&nbsp;처리<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></blockquote><br>다른 방법으로, callback 함수를 인라인으로 정의하고, HTTP 상태 코드가 200일때만 작업하도록 할 수도 있다. 두가지를 한꺼번에 보면,<br><blockquote class="src">request.onreadystatechange&nbsp;=&nbsp;funcation()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request.readyState&nbsp;==&nbsp;4&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.status&nbsp;==&nbsp;200)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;착신시의&nbsp;처리<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></blockquote><br>onreadystatechange 대신 onload를 사용할 수 있다. Opera 8은 버그때문에 onload만 사용한다. (IE를 제외한 다른 브라우저에서 다 된다) <br><blockquote class="src">request.onload&nbsp;=&nbsp;function()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;착신시의&nbsp;처리<br>}<br></blockquote><br>onload와 onreadystatechange를 동시에 이용하기 위해서 다음과 같이한다.<br><blockquote class="src">if&nbsp;(window.opera)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;request.onload&nbsp;=&nbsp;function()&nbsp;{&nbsp;callback(request);&nbsp;}<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;request.onreadystatechange&nbsp;=&nbsp;function()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request.readyState&nbsp;==&nbsp;4)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(request);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>function&nbsp;callback(request)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;실제&nbsp;착신시의&nbsp;처리를&nbsp;구현하는&nbsp;부분<br>}<br></blockquote><br>&nbsp;* responseText 또는 responseXML (데이터를 텍스트 혹은 DOMDocument로 수신)<br>&nbsp;&nbsp;&nbsp;* responseText : 텍스트로 받기<br>&nbsp;&nbsp;&nbsp;* responseXml : XML로 받기<br>&nbsp;&nbsp;&nbsp;* 여러줄의 CSV 텍스트를 받았을 때의 일반적 처리<br><blockquote class="src">var&nbsp;res&nbsp;=&nbsp;request.responseText;<br>var&nbsp;rows&nbsp;=&nbsp;res.split("<br>");&nbsp;//&nbsp;여러&nbsp;줄을&nbsp;한&nbsp;줄씩&nbsp;배열로&nbsp;만든다.<br>var&nbsp;cols&nbsp;=&nbsp;rows[0].split(",");&nbsp;//&nbsp;첫번째&nbsp;줄을&nbsp;쉼표&nbsp;단위로&nbsp;분리하여&nbsp;배열로&nbsp;만든다.<br></blockquote><br>&nbsp;&nbsp;&nbsp;* JSON 처리<br><blockquote class="src">eval("res&nbsp;=&nbsp;"&nbsp;+&nbsp;request.responseText)<br>//...&nbsp;기타&nbsp;처리<br></blockquote><br>&nbsp;&nbsp;&nbsp;* XML 처리<br><blockquote class="src">&lt;?xml&nbsp;version="1.0"?&gt;<br>&lt;lists&gt;<br>&nbsp;&nbsp;&lt;name&gt;Toshiro&nbsp;Takahashi&lt;/name&gt;<br>&nbsp;&nbsp;&lt;msg&gt;hello&lt;/msg&gt;<br>&lt;/lists&gt;<br></blockquote><br><blockquote class="src">var&nbsp;res&nbsp;=&nbsp;request.responseXML;<br>var&nbsp;msgs&nbsp;=&nbsp;res.getElementsByTagName("msg");&nbsp;//&nbsp;DOM&nbsp;객체&nbsp;사용<br><br>alert(msg[0].firstChild.nodeValue);<br></blockquote><br><br><div class="h3">서버측 스크립트</div><br>XMLHttpRequest.send() 에 의해 요청을 받아 처리하게 되는 서버측 스크립트(JSP, Servlet, ASP, PHP 등)은 요청 파라미터를 분석하여 작업을 처리한 뒤에 결과를 Text나 XML로 리턴하면 된다. <br>&nbsp;* 리턴시 문자 인코딩은 기본적으로 UTF-8로 한다.<br>&nbsp;* 텍스트로 리턴할 경우, Opera 8, Konqueror 3, Safari 등은 UTF-8을 인식하지 못한다. 서버는 응답 문자열을 UTF-8기준으로 URI 인코딩을 해서(Java의 경우 java.net.URLEncoder.encode() 메소드 사용) 리턴하고, 받는 측(웹 브라우져)는 다음과 같이 해석하면 정상적인 문자열을 받게 된다.(실제로는 작동하지 않으므로 URLEncoder를 사용하지말고 받는 자바 스크립트 측에서도 아래와 같이 받지 말고 그냥 request.responseText를 받을 것)<br><blockquote class="src">//&nbsp;Mozilla&nbsp;FireFox와&nbsp;IE에서는&nbsp;Encode/Decode할&nbsp;경우<br>//공백이&nbsp;+로&nbsp;바뀌는&nbsp;현상이&nbsp;발생했다.&nbsp;그래서&nbsp;안쓴다.<br>//&nbsp;JavaScript측에서&nbsp;decodeURIComponent를&nbsp;안하면&nbsp;서버측에서도&nbsp;URLEncoding을&nbsp;하면&nbsp;안된다.<br>var&nbsp;res&nbsp;=&nbsp;decodeURIComponent(request.responseText);<br></blockquote><br><br><div class="h3">JSP/Servlet 에서 Ajax와 한글 인코딩 문제</div><br>Ajax는 기본적으로 UTF-8 만으로 통신을 한다고 보면된다. 그 이외의 Encoding을 지원하는 인코딩 함수가 없기 때문에 EUC-KR로 데이터를 전송하려는 꿈은 접어야만 한다.<br>헌데, 아직 우리나라는 EUC-KR 인코딩으로 된 웹 어플리케이션이 압도적으로 많은 상황이다(어서 빨리 UTF-8로 옮겨가길 바라마지 않는다).<br>거기다가 보통 JSP/Servlet 웹 어플리케이션은 Servlet 스펙 2.3이후부터 문자 인코딩 서블릿 필터를 사용해 모든 요청에 대해 일관된 문자 인코딩을 사용하는 것이 보편적인 방법으로 자리잡았다.<br><br>서블릿 필터는 일관성있게 모든 요청을 EUC-KR로 받아들이게 했는데, 몇몇 Ajax관련 요청만 UTF-8로 받아들여야만 하는 것이다.<br>필터를 적용할 URL-Pattern을 따로 줘보려 했으나, 너무 복잡해졌다.<br>그래서 HTTP 요청의 헤더를 이용해서 해결 했다.<br><br>아.. 한가지 더. 현재 한글 문제는 "XMLHttpRequest 요청 -> JSP/Servlet" 이 상황에서만 발생하는 것이다.<br>"JSP/Servlet -> XMLHttpRequest"의 상황(서버에서 클라이언트로 값을 리턴)에서는 이 문제가 발생하지 않는다.<br>서버가 리턴하는 문자열은 간단하게 다음처럼 하면 WAS가 자동으로 UTF-8로 값을 변경해서 전달하기 때문이다.<br><blockquote class="src">&lt;%@&nbsp;page&nbsp;<strong>contentType="text/plain;&nbsp;charset=utf-8"</strong>&nbsp;pageEncoding="EUC-KR"%&gt;<br></blockquote><br>contentType에서 text/plain은 텍스트나 JSON으로 값을 리턴할 때이다. XML로 리턴할 때는 text/xml.<br><br>아래는 Ajax 요청을 처리하기 위해서 만들어본 간단한 Encoding Filter 이다.<br><blockquote class="src">package&nbsp;ajax.filter;<br><br>import&nbsp;java.io.IOException;<br><br>import&nbsp;javax.servlet.Filter;<br>import&nbsp;javax.servlet.FilterChain;<br>import&nbsp;javax.servlet.FilterConfig;<br>import&nbsp;javax.servlet.ServletException;<br>import&nbsp;javax.servlet.ServletRequest;<br>import&nbsp;javax.servlet.ServletResponse;<br>import&nbsp;javax.servlet.http.HttpServletRequest;<br><br>import&nbsp;org.apache.commons.logging.Log;<br>import&nbsp;org.apache.commons.logging.LogFactory;<br><br>/**<br>&nbsp;*&nbsp;어플리케이션&nbsp;전체에&nbsp;적용되는&nbsp;필터이다.<br>&nbsp;*&nbsp;<br>&nbsp;*&nbsp;&lt;ul&gt;<br>&nbsp;*&nbsp;&lt;li&gt;encoding&nbsp;파라미터&nbsp;:&nbsp;encoding&nbsp;파라미터를&nbsp;설정하면&nbsp;request&nbsp;객체에<br>&nbsp;*&nbsp;setCharacterEncoding(encoding)을&nbsp;실행한다.&lt;/li&gt;<br>&nbsp;*&nbsp;&lt;li&gt;ajaxFlag&nbsp;파라미터&nbsp;:&nbsp;Ajax요청임을&nbsp;나타내는&nbsp;HTTP&nbsp;파라미터&nbsp;이름이다.&nbsp;ajaxFilter로&nbsp;지정한&nbsp;HTTP&nbsp;파라미터의<br>&nbsp;*&nbsp;값이&nbsp;true&nbsp;로&nbsp;설정되면&nbsp;인코딩을&nbsp;무조건&nbsp;UTF-8로&nbsp;설정한다.&lt;/li&gt;<br>&nbsp;*&nbsp;&lt;/ul&gt;<br>&nbsp;*&nbsp;<br>&nbsp;*&nbsp;@author&nbsp;손권남(kwon37xi@yahoo.co.kr)<br>&nbsp;*&nbsp;<br>&nbsp;*/<br>public&nbsp;class&nbsp;EncodingFilter&nbsp;implements&nbsp;Filter&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Log&nbsp;log&nbsp;=&nbsp;LogFactory.getLog(this.getClass());<br><br>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;HTTP&nbsp;요청&nbsp;문자&nbsp;인코딩&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;encoding&nbsp;=&nbsp;null;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Ajax&nbsp;요청임을&nbsp;나타내는&nbsp;플래그&nbsp;파라미터&nbsp;이름&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;ajaxFlag&nbsp;=&nbsp;null;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;doFilter(ServletRequest&nbsp;request,&nbsp;ServletResponse&nbsp;response,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FilterChain&nbsp;chain)&nbsp;throws&nbsp;IOException,&nbsp;ServletException&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ajaxFlag&nbsp;!=&nbsp;null<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;"true".equals(((HttpServletRequest)&nbsp;request)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getHeader(ajaxFlag)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Ajax&nbsp;처리&nbsp;요청일&nbsp;경우&nbsp;무조건&nbsp;UTF-8&nbsp;지정.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setCharacterEncoding("UTF-8");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(log.isDebugEnabled())&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.debug("요청&nbsp;헤더에&nbsp;"&nbsp;+&nbsp;ajaxFlag&nbsp;+&nbsp;"가&nbsp;"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;((HttpServletRequest)&nbsp;request).getHeader(ajaxFlag)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;"로&nbsp;설정되어&nbsp;있어&nbsp;문자&nbsp;인코딩에&nbsp;&nbsp;UTF-8을&nbsp;사용합니다.");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(encoding&nbsp;!=&nbsp;null)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Ajax&nbsp;플래그가&nbsp;true가&nbsp;아니면,&nbsp;기본적인&nbsp;인코딩을&nbsp;적용한다.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setCharacterEncoding(encoding);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(log.isDebugEnabled())&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.debug("문자&nbsp;인코딩에&nbsp;"&nbsp;+&nbsp;encoding&nbsp;+&nbsp;"을&nbsp;사용합니다.");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.doFilter(request,&nbsp;response);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;init(FilterConfig&nbsp;config)&nbsp;throws&nbsp;ServletException&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoding&nbsp;=&nbsp;config.getInitParameter("encoding");<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ajaxFlag&nbsp;=&nbsp;config.getInitParameter("ajaxFlag");<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(log.isDebugEnabled())&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.info("encoding&nbsp;:&nbsp;"&nbsp;+&nbsp;encoding&nbsp;+&nbsp;",&nbsp;ajaxFlag&nbsp;:&nbsp;"&nbsp;+&nbsp;ajaxFlag);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;destroy()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></blockquote><br>이 필터를 적용하고서, web.xml에 다음 내용을 추가하면 필터가 작동한다.<br><blockquote class="src">&lt;filter&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;description&gt;이중&nbsp;인코딩&nbsp;필터&lt;/description&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;EncodingFilter&lt;/filter-name&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-class&gt;ajax.filter.EncodingFilter&lt;/filter-class&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;encoding&lt;/param-name&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;euc-kr&lt;/param-value&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;ajaxFlag&lt;/param-name&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;Ajax&lt;/param-value&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;<br>&lt;/filter&gt;<br>&lt;filter-mapping&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;EncodingFilter&lt;/filter-name&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br>&lt;/filter-mapping&gt;<br></blockquote><br>여기 내용을 보면, 기본적인 인코딩은 EUC-KR이고, 요청 헤더에 "Ajax" 헤더의 값이 "true"일 경우에는 강제로 UTF-8을 지정하라고 한 것이다. "ajaxFlag"의 값을 변경하면 헤더의 키을 "Ajax"가 아닌 다른 값으로도 지정할 수 있다. 하지만 아무튼 해당 헤더의 값을 "true"로 지정하면 Ajax로 인식하게 되는 것이다.<br><br>이를 위해서는 XMLHttpRequest에도 한가지 처리를 더 보태야 한다.<br><blockquote class="src">&nbsp;&nbsp;&nbsp;&nbsp;request.open("GET",&nbsp;"AjaxProcessor.jsp"&nbsp;+&nbsp;fullParameter);<br>&nbsp;&nbsp;&nbsp;&nbsp;request.setRequestHeader('Content-Type',&nbsp;'application/x-www-form-urlencoded;&nbsp;charset=UTF-8');<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong>request.setRequestHeader('Ajax',&nbsp;'true');</strong><br></blockquote><br>당연히 헤더에 값 Ajax요청임을 명시하는 값을 설정하는 것이다.<br><br>그리고 다음 문제가 또 있는데, Tomcat 버전별로 문자 인코딩 설정이 달라질 수 있다는 것이다.<br>위 내용은 Tomcat 4.x에서는 정상 작동하지만, Tomcat 5.x 에서는 제대로 작동하지 않는다.<br>Tomcat 5.x에서는 server.xml 에 GET 방식의 요청에 대한 인코딩을 지정하기 때문이다.<br>여기서 URIEncoding="euc-kr" 을 사용하지 않고, <strong>useBodyEncodingForURI="true"</strong>을 사용하면 Tomcat 4.x 처럼 request.setCharacterEncoding()의 값을 따라가게 할 수 있다.<br>Tomcat과 한글에 대해서는 <a title="" href="http://kwon37xi.egloos.com/1462013">Tomcat/JSP와 한글</a>문서를 참조한다.<br><br>또하나 Ajax임을 나타내는 플래그를 HTTP 요청 헤더에 설정하도록 했는데, 그러지 않고 요청 파라미터(request.getParameter()로 값을 얻어올 수 있는 것)으로 설정하면 안된다.<br>request.getParameter()가 실행되어 Ajax 플래그의 값을 감지하는 그 순간, 그 이후 호출되는 request.setCharacterEncoding()는 완전히 무시되어 버리기 때문이다.<br><br><div class="h2">예제</div><br>급조한 예제이다.<br>* AjaxCaller.jsp - Ajax 호출부(클라이언트) : 수식을 만들어서 서버측에 계산을 요청한다.<br><blockquote class="src">&lt;%@&nbsp;page&nbsp;language="java"&nbsp;contentType="text/html;&nbsp;charset=EUC-KR"<br>&nbsp;&nbsp;&nbsp;&nbsp;pageEncoding="EUC-KR"%&gt;<br>&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;"-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN"&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta&nbsp;http-equiv="Content-Type"&nbsp;content="text/html;&nbsp;charset=EUC-KR"&gt;<br>&lt;title&gt;Insert&nbsp;title&nbsp;here&lt;/title&gt;<br>&lt;script&nbsp;type="text/javascript"&gt;<br>//&nbsp;XMLHttpRequest&nbsp;오브젝트&nbsp;생성&nbsp;함수<br>//&nbsp;@sample&nbsp;oj&nbsp;=&nbsp;createHttpRequest();<br>//&nbsp;@return&nbsp;XMLHttpRequest&nbsp;오브젝트<br>function&nbsp;createHttpRequest()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window.ActiveXObject)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;IE6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ActiveXObject("Msxml2.XMLHTTP");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(e)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;IE4,&nbsp;IE5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ActiveXObject("Microsoft.XMLHTTP");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(e2)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(window.XMLHttpRequest)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Mozilla,&nbsp;FireFox,&nbsp;Opera,&nbsp;Safari,&nbsp;Konqueror3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;XMLHttpRequest();<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>//&nbsp;계산을&nbsp;수행한다.<br>function&nbsp;calc()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;request&nbsp;=&nbsp;createHttpRequest();<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;nameParam&nbsp;=&nbsp;encodeURIComponent("name");<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;nameValue&nbsp;=&nbsp;encodeURIComponent(document.getElementById("name").value);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oper1Param&nbsp;=&nbsp;encodeURIComponent("oper1");<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oper1Value&nbsp;=&nbsp;encodeURIComponent(document.getElementById("oper1").value);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oper2Param&nbsp;=&nbsp;encodeURIComponent("oper2");<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oper2Value&nbsp;=&nbsp;encodeURIComponent(document.getElementById("oper2").value);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;operatorParam&nbsp;=&nbsp;encodeURIComponent("operator");<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;operatorValue&nbsp;=&nbsp;encodeURIComponent(document.getElementById("operator").value);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fullParameter&nbsp;=<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"?"&nbsp;+&nbsp;nameParam&nbsp;+&nbsp;"="&nbsp;+&nbsp;nameValue<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;"&amp;"&nbsp;+&nbsp;oper1Param&nbsp;+&nbsp;"="&nbsp;+&nbsp;oper1Value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;"&amp;"&nbsp;+&nbsp;oper2Param&nbsp;+&nbsp;"="&nbsp;+&nbsp;oper2Value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;"&amp;"&nbsp;+&nbsp;operatorParam&nbsp;+&nbsp;"="&nbsp;+&nbsp;operatorValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;request.onreadystatechange&nbsp;=&nbsp;function()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request.readyState&nbsp;==&nbsp;4)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert("Response&nbsp;:&nbsp;"&nbsp;+&nbsp;request.responseText);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("var&nbsp;result&nbsp;=&nbsp;"&nbsp;+&nbsp;request.responseText);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(result.name&nbsp;+&nbsp;"님&nbsp;계산결과는&nbsp;"&nbsp;+&nbsp;result.value&nbsp;+&nbsp;"입니다.");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;request.open("GET",&nbsp;"AjaxProcessor.jsp"&nbsp;+&nbsp;fullParameter);<br>&nbsp;&nbsp;&nbsp;&nbsp;request.setRequestHeader('Content-Type',&nbsp;'application/x-www-form-urlencoded;&nbsp;charset=UTF-8');<br>&nbsp;&nbsp;&nbsp;&nbsp;request.setRequestHeader('Ajax',&nbsp;'true');<br>&nbsp;&nbsp;&nbsp;&nbsp;request.send("");<br><br>}&nbsp;//&nbsp;end&nbsp;of&nbsp;calc()<br>&lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>이름&nbsp;:&nbsp;&lt;input&nbsp;type="text"&nbsp;id="name"&nbsp;/&gt;&nbsp;&lt;br&nbsp;/&gt;<br>&lt;input&nbsp;type="text"&nbsp;id="oper1"&nbsp;/&gt;<br>&lt;select&nbsp;id="operator"&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value="+"&gt;+&lt;/option&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value="-"&gt;-&lt;/option&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value="*"&gt;*&lt;/option&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value="/"&gt;/&lt;/option&gt;<br>&lt;/select&gt;<br>&lt;input&nbsp;type="text"&nbsp;id="oper2"&nbsp;/&gt;<br>&lt;input&nbsp;type="button"&nbsp;value="계산하기"&nbsp;onclick="calc()"&nbsp;/&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></blockquote><br>* AjaxProcessor.jsp - Ajax 처리부(서버) : 수식을 계산한 결과를 JSON 형태로 리턴한다<br><blockquote class="src">&lt;%@&nbsp;page&nbsp;contentType="text;&nbsp;charset=utf-8"&nbsp;pageEncoding="EUC-KR"%&gt;<br>&lt;%<br>System.out.println("AjaxProcessor.jsp&nbsp;시작");<br><br>String&nbsp;result&nbsp;=&nbsp;null;<br><br>String&nbsp;name&nbsp;=&nbsp;request.getParameter("name");<br>String&nbsp;oper1&nbsp;=&nbsp;request.getParameter("oper1");<br>String&nbsp;oper2&nbsp;=&nbsp;request.getParameter("oper2");<br>String&nbsp;operator&nbsp;=&nbsp;request.getParameter("operator");<br><br>double&nbsp;oper1Value&nbsp;=&nbsp;Double.parseDouble(oper1);<br>double&nbsp;oper2Value&nbsp;=&nbsp;Double.parseDouble(oper2);<br><br>double&nbsp;calcResult&nbsp;=&nbsp;0;<br><br>if&nbsp;("+".equals(operator))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;calcResult&nbsp;=&nbsp;oper1Value&nbsp;+&nbsp;oper2Value;<br>}&nbsp;else&nbsp;if&nbsp;("-".equals(operator))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;calcResult&nbsp;=&nbsp;oper1Value&nbsp;-&nbsp;oper2Value;<br>}&nbsp;else&nbsp;if&nbsp;("*".equals(operator))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;calcResult&nbsp;=&nbsp;oper1Value&nbsp;*&nbsp;oper2Value;<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;calcResult&nbsp;=&nbsp;oper1Value&nbsp;/&nbsp;oper2Value;<br>}<br><br>result&nbsp;=&nbsp;"{&nbsp;<br>"&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;""name"&nbsp;:&nbsp;""&nbsp;+&nbsp;name&nbsp;+&nbsp;"",<br>"&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;""value"&nbsp;:&nbsp;""&nbsp;+&nbsp;calcResult&nbsp;+&nbsp;""<br>"&nbsp;+<br>&nbsp;&nbsp;&nbsp;&nbsp;"}<br>";<br>System.out.println("Result&nbsp;:&nbsp;"&nbsp;+&nbsp;result);<br><br>%&gt;&lt;%=&nbsp;result%&gt;&lt;%<br>System.out.println("AjaxProcessor.jsp&nbsp;끝");<br>%&gt;<br></blockquote><br>이름 입력 부분에 한글을 입력하여 문제없이 처리되는지 확인해보기 바란다.<br><br><div class="h2">JSON</div><br>Ajax(JavaScript)는 데이터를 리턴 받는 방법으로 XML/Text/JSON을 지원한다. JSON은 텍스트 형태로 객체를 정의하는 방식이다. 이것은 XML과 1:1 매칭을 할 수도 있다. XML보다 훨씬 만들기 쉽고 사용법도 자바 객체를 사용하는 것과 유사하다. 그래서 이걸 사용해서 프로그램을 작성했다.<br><blockquote class="src">{<br>&nbsp;&nbsp;"test1":&nbsp;"hello",<br>&nbsp;&nbsp;"test2":&nbsp;"hello2"<br>}<br></blockquote><br>위와 같은 메시지를 서버에서 응답으로 내보냈다고 할 때<br><blockquote class="src">//&nbsp;JSON&nbsp;형태의&nbsp;텍스트를&nbsp;JavaScript&nbsp;객체화&nbsp;한다.<br>eval("res&nbsp;=&nbsp;"&nbsp;+&nbsp;request.responseText);<br><br>//&nbsp;객체를&nbsp;사용한다.<br>alert(res.test2);&nbsp;//&nbsp;이&nbsp;명령은&nbsp;"hello2"를&nbsp;출력한다.<br></blockquote><br>배열은 다음과 같이 생성한다.<br><blockquote class="src">[<br>&nbsp;&nbsp;["test1",&nbsp;"test2"],<br>&nbsp;&nbsp;["test3",&nbsp;"test4"]<br>]<br></blockquote><br>아래와 같이 사용한다.<br><blockquote class="src">eval("res&nbsp;=&nbsp;"&nbsp;+&nbsp;request.responseText);<br><br>//&nbsp;test4를&nbsp;출력한다.<br>alert(res[1][1])<br></blockquote><br>&nbsp;* JSON 홈페이지 : <a title="" href="http://www.json.org/">http://www.json.org/</a><br>&nbsp;* Java 객체를 이용해서 JSON 객체를 위한 텍스트 생성하기 : <a title="" href="http://www.json.org/java/simple.txt">http://www.json.org/java/simple.txt</a>  매우 단순한 방법으로 핵심 기능만 가지고 있다. 이것을 사용하길 권장한다. 라이브러리 다운로드는 <a title="" href="http://www.JSON.org/java/json_simple.zip">http://www.JSON.org/java/json_simple.zip</a> 에서 한다. <br>&nbsp;* <a title="" href="http://network.hanbitbook.co.kr/view.php?bi_id=1235">XML과 JSON간의 변환</a></div>
                        <div class="post-footer">
                            <button class="btn" onclick="button_click();">목록</button>
                        </div>
                    </div>
                </article>
            </main>
        </section>

        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

        <script>
            function button_click() {
                if(history.length > 1) {
                    history.back();
                } else {
                    document.location.href = "../../블로그포스트목록.html";
                }
            }
        </script>
    </body>
</html>
